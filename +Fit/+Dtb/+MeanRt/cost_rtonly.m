function [cost,grad,hess] = cost_rtonly(b,coh,coh0,k,rt_obs,rt_sem_obs,tnd)
%COST_RTONLY
%    [COST,GRAD,HESS] = COST_RTONLY(B,COH,COH0,K,RT_OBS,RT_SEM_OBS,TND)

%    This function was generated by the Symbolic Math Toolbox version 6.3.
%    08-Aug-2016 09:32:19

cost = log(rt_sem_obs)+1.0./rt_sem_obs.^2.*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))).^2.*(1.0./2.0);
if nargout > 1
    grad = [-1.0./rt_sem_obs.^2.*(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0)-tanh(b.*k.*(coh-coh0))./(k.*(coh-coh0))).*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))),-1.0./rt_sem_obs.^2.*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./k+(b.*1.0./k.^2.*tanh(b.*k.*(coh-coh0)))./(coh-coh0)).*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))),1.0./rt_sem_obs.^2.*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(coh-coh0)+(b.*tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2)./k).*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))),1.0./rt_sem_obs.^2.*(rt_obs.*-2.0+tnd.*2.0+(b.*tanh(b.*k.*(coh-coh0)).*2.0)./(k.*(coh-coh0))).*(1.0./2.0)];
end
if nargout > 2
    hess = reshape([1.0./rt_sem_obs.^2.*(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0)-tanh(b.*k.*(coh-coh0))./(k.*(coh-coh0))).^2+1.0./rt_sem_obs.^2.*(tanh(b.*k.*(coh-coh0)).^2.*-2.0+b.*k.*tanh(b.*k.*(coh-coh0)).*(coh-coh0).*(tanh(b.*k.*(coh-coh0)).^2-1.0).*2.0+2.0).*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))),-1.0./rt_sem_obs.^2.*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))).*((1.0./k.^2.*tanh(b.*k.*(coh-coh0)))./(coh-coh0)+(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./k-b.^2.*tanh(b.*k.*(coh-coh0)).*(coh-coh0).*(tanh(b.*k.*(coh-coh0)).^2-1.0).*2.0)+1.0./rt_sem_obs.^2.*(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0)-tanh(b.*k.*(coh-coh0))./(k.*(coh-coh0))).*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./k+(b.*1.0./k.^2.*tanh(b.*k.*(coh-coh0)))./(coh-coh0)),1.0./rt_sem_obs.^2.*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))).*((tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2)./k+(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(coh-coh0)-b.^2.*k.*tanh(b.*k.*(coh-coh0)).*(tanh(b.*k.*(coh-coh0)).^2-1.0).*2.0)-1.0./rt_sem_obs.^2.*(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0)-tanh(b.*k.*(coh-coh0))./(k.*(coh-coh0))).*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(coh-coh0)+(b.*tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2)./k),-1.0./rt_sem_obs.^2.*(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0)-tanh(b.*k.*(coh-coh0))./(k.*(coh-coh0))),-1.0./rt_sem_obs.^2.*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))).*((1.0./k.^2.*tanh(b.*k.*(coh-coh0)))./(coh-coh0)+(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./k-b.^2.*tanh(b.*k.*(coh-coh0)).*(coh-coh0).*(tanh(b.*k.*(coh-coh0)).^2-1.0).*2.0)+1.0./rt_sem_obs.^2.*(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0)-tanh(b.*k.*(coh-coh0))./(k.*(coh-coh0))).*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./k+(b.*1.0./k.^2.*tanh(b.*k.*(coh-coh0)))./(coh-coh0)),1.0./rt_sem_obs.^2.*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./k+(b.*1.0./k.^2.*tanh(b.*k.*(coh-coh0)))./(coh-coh0)).^2+1.0./rt_sem_obs.^2.*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))).*(b.^2.*1.0./k.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0).*2.0+(b.*1.0./k.^3.*tanh(b.*k.*(coh-coh0)).*2.0)./(coh-coh0)+(b.^3.*tanh(b.*k.*(coh-coh0)).*(coh-coh0).*(tanh(b.*k.*(coh-coh0)).^2-1.0).*2.0)./k),-1.0./rt_sem_obs.^2.*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))).*(b.^3.*tanh(b.*k.*(coh-coh0)).*(tanh(b.*k.*(coh-coh0)).^2-1.0).*2.0+b.*1.0./k.^2.*tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2+(b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(k.*(coh-coh0)))-1.0./rt_sem_obs.^2.*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./k+(b.*1.0./k.^2.*tanh(b.*k.*(coh-coh0)))./(coh-coh0)).*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(coh-coh0)+(b.*tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2)./k),-1.0./rt_sem_obs.^2.*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./k+(b.*1.0./k.^2.*tanh(b.*k.*(coh-coh0)))./(coh-coh0)),1.0./rt_sem_obs.^2.*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))).*((tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2)./k+(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(coh-coh0)-b.^2.*k.*tanh(b.*k.*(coh-coh0)).*(tanh(b.*k.*(coh-coh0)).^2-1.0).*2.0)-1.0./rt_sem_obs.^2.*(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0)-tanh(b.*k.*(coh-coh0))./(k.*(coh-coh0))).*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(coh-coh0)+(b.*tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2)./k),-1.0./rt_sem_obs.^2.*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))).*(b.^3.*tanh(b.*k.*(coh-coh0)).*(tanh(b.*k.*(coh-coh0)).^2-1.0).*2.0+b.*1.0./k.^2.*tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2+(b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(k.*(coh-coh0)))-1.0./rt_sem_obs.^2.*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./k+(b.*1.0./k.^2.*tanh(b.*k.*(coh-coh0)))./(coh-coh0)).*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(coh-coh0)+(b.*tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2)./k),1.0./rt_sem_obs.^2.*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(coh-coh0)+(b.*tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2)./k).^2+1.0./rt_sem_obs.^2.*(-rt_obs+tnd+(b.*tanh(b.*k.*(coh-coh0)))./(k.*(coh-coh0))).*(b.^2.*1.0./(coh-coh0).^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0).*2.0+(b.*tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^3.*2.0)./k+(b.^3.*k.*tanh(b.*k.*(coh-coh0)).*(tanh(b.*k.*(coh-coh0)).^2-1.0).*2.0)./(coh-coh0)),1.0./rt_sem_obs.^2.*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(coh-coh0)+(b.*tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2)./k),-1.0./rt_sem_obs.^2.*(b.*(tanh(b.*k.*(coh-coh0)).^2-1.0)-tanh(b.*k.*(coh-coh0))./(k.*(coh-coh0))),-1.0./rt_sem_obs.^2.*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./k+(b.*1.0./k.^2.*tanh(b.*k.*(coh-coh0)))./(coh-coh0)),1.0./rt_sem_obs.^2.*((b.^2.*(tanh(b.*k.*(coh-coh0)).^2-1.0))./(coh-coh0)+(b.*tanh(b.*k.*(coh-coh0)).*1.0./(coh-coh0).^2)./k),1.0./rt_sem_obs.^2],[4,4]);
end
